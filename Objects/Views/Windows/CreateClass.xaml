<Window x:Class="Incas.Objects.Views.Windows.CreateClass"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:conv="clr-namespace:Incas.Core.Converters"
        xmlns:local="clr-namespace:Incas.Objects.Views.Windows" xmlns:fa="http://schemas.fontawesome.io/icons/" xmlns:local1="clr-namespace:Incas.Objects.Converters" xmlns:classes="clr-namespace:Incas.Objects.Views.Controls" xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit" xmlns:system="clr-namespace:System;assembly=mscorlib" xmlns:ngv="clr-namespace:NodeGraph.View;assembly=NodeGraph"
        mc:Ignorable="d"
        Title="Создать класс" Height="750" Width="1000" MinHeight="750" MinWidth="960" WindowStartupLocation="CenterScreen" Style="{StaticResource WindowBase}" Background="{StaticResource Black}">
    <Window.Resources>
        <ResourceDictionary>
            <local1:FieldTypeToColorConverter x:Key="FieldTypeToColorConverter"/>
            <local1:FieldTypeToVisibleNameConverter x:Key="FieldTypeToVisibleNameConverter"/>
            <conv:IEColorToBrushConverter x:Key="IEColorToBrushConverter"/>
            <conv:PathDataToGeometryConverter x:Key="PathDataToGeometryConverter"/>
        </ResourceDictionary>
    </Window.Resources>
    <Grid Grid.ColumnSpan="2">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="50"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="50"/>
        </Grid.RowDefinitions>
        <Grid Grid.Column="1" Grid.ColumnSpan="2" Panel.ZIndex="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
        </Grid>

        <TabControl x:Name="TabControlMain" Style="{StaticResource TabControlMain}" Background="{DynamicResource Black}" Margin="0" ItemContainerStyle="{StaticResource TabItemMain}" Grid.RowSpan="2" Grid.ColumnSpan="2">
            <TabItem Header="Атрибуты и поля"  BorderBrush="{DynamicResource LightPurple}">
                <Grid Background="{DynamicResource Black}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="5*" MinWidth="250" />
                        <ColumnDefinition Width="5*" MaxWidth="850"/>
                        <ColumnDefinition Width="50"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Row="2" Grid.Column="3" Margin="5" Background="{DynamicResource Black}" CornerRadius="8">
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,5,0,0" Cursor="" >

                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="AddFieldClick" ToolTip="Добавить поле">
                                <Path Fill="{StaticResource Buttons.Green}" Data="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3z" VerticalAlignment="Center"/>
                            </Button>
                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="CopyFieldsFromAnotherClass" ToolTip="Скопировать поля из другого класса">
                                <Path Fill="{StaticResource Buttons.Green}" VerticalAlignment="Center" Data="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5z M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5zm4.5 6V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5a.5.5 0 0 1 1 0"/>
                            </Button>
 
                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="AddVirtualFieldsClick" ToolTip="Создать виртуальные поля">
                                <Path Fill="{StaticResource Buttons.Green}" VerticalAlignment="Center" Data="{StaticResource Magic}"/>
                            </Button>
                            <Rectangle Height="1" Fill="{DynamicResource LightBlack}" Margin="4,2,4,2"/>

                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="MinimizeAllClick" ToolTip="Свернуть все поля">
                                <Path Fill="DodgerBlue" VerticalAlignment="Center" Stretch="Uniform" Data="M7.5519,19.8462V16.4385H4.1441v-.923H8.4749v4.3307Zm7.9855,0V15.5155h4.3185v.923H16.4606v3.4077ZM4.1441,8.472V7.549H7.5519V4.1538h.923V8.472Zm11.3933,0V4.1538h.9232V7.549h3.3953v.923Z"/>
                            </Button>
                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="MaximizeAllClick" ToolTip="Развернуть все поля">
                                <Path Fill="DodgerBlue" VerticalAlignment="Center" Stretch="Uniform" Data="M4.1441,19.8462V15.5155h.9233V18.923H8.4749v.9232Zm11.3933,0V18.923h3.3952V15.5155h.9233v4.3307ZM4.1441,8.472V4.1538H8.4749V5.077H5.0674V8.472Zm14.7885,0V5.077H15.5374V4.1538h4.3185V8.472Z"/>
                            </Button>

                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="ShowFormClick" ToolTip="Предпросмотр формы">
                                <Path Fill="DodgerBlue" VerticalAlignment="Center" Stretch="Uniform" Data="M6.277,21.8462H3.689A1.52,1.52,0,0,1,2.1538,20.311V17.723H3.077v2.5848a.5922.5922,0,0,0,.6153.6152H6.277Zm11.4585,0V20.923h2.5723a.5922.5922,0,0,0,.6152-.6153V17.723h.9232v2.588a1.5194,1.5194,0,0,1-1.5352,1.5352ZM12.0033,17.623A7.9286,7.9286,0,0,1,7.2818,16.14,9.1091,9.1091,0,0,1,4.1345,12a9.1447,9.1447,0,0,1,3.149-4.1462,7.8988,7.8988,0,0,1,4.7133-1.4893A7.9406,7.9406,0,0,1,16.72,7.8538,9.1193,9.1193,0,0,1,19.878,12a9.0867,9.0867,0,0,1-3.16,4.1385A7.9489,7.9489,0,0,1,12.0033,17.623ZM11.997,16.7A6.9637,6.9637,0,0,0,16.04,15.47a8.3206,8.3206,0,0,0,2.82-3.4693,8.37,8.37,0,0,0-2.82-3.4762,6.9357,6.9357,0,0,0-4.0425-1.237,6.9418,6.9418,0,0,0-4.0447,1.237A8.2139,8.2139,0,0,0,5.153,12a8.1829,8.1829,0,0,0,2.7993,3.4678A6.9615,6.9615,0,0,0,11.997,16.7Zm-.0015-1.9088a2.7168,2.7168,0,0,0,1.991-.8095,2.8238,2.8238,0,0,0,0-3.9682,2.8218,2.8218,0,0,0-3.9665,0,2.8321,2.8321,0,0,0-.0017,3.9665A2.6874,2.6874,0,0,0,11.9955,14.7912ZM12,13.8682a1.8826,1.8826,0,0,1-1.3278-3.2027A1.8832,1.8832,0,0,1,13.3345,13.33,1.822,1.822,0,0,1,12,13.8682ZM2.1538,6.2645V3.689A1.5194,1.5194,0,0,1,3.689,2.1538H6.277V3.077H3.6923a.5922.5922,0,0,0-.6153.6152V6.2645Zm18.7692,0V3.6922a.5922.5922,0,0,0-.6152-.6152H17.7355V2.1538H20.311A1.5193,1.5193,0,0,1,21.8462,3.689V6.2645Z"/>
                            </Button>

                            <Rectangle Height="1" Fill="{DynamicResource LightBlack}" Margin="4,2,4,2"/>
                            
                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Black}" Click="GetMoreInfoClick" ToolTip="Открыть справочную информацию">
                                <Path Fill="#FF78DDFF" VerticalAlignment="Center" Stretch="Uniform" Data="M12.9356,17.9427a.78.78,0,1,0-.5605-.2277A.7589.7589,0,0,0,12.9356,17.9427Zm-.5165-3.3115h.9655a2.7092,2.7092,0,0,1,.245-1.06,4.5017,4.5017,0,0,1,.851-1.04,6.9246,6.9246,0,0,0,.9963-1.199,2.2871,2.2871,0,0,0,.327-1.2265,2.3407,2.3407,0,0,0-.8308-1.8842A2.9485,2.9485,0,0,0,13.0076,7.52a2.89,2.89,0,0,0-1.8317.5865,3.6369,3.6369,0,0,0-1.1028,1.348l.919.3808A2.9346,2.9346,0,0,1,11.68,8.87a1.8167,1.8167,0,0,1,1.2895-.4192A1.7552,1.7552,0,0,1,14.39,8.984a1.7859,1.7859,0,0,1,.448,1.1742,1.5992,1.5992,0,0,1-.2808.9278,4.909,4.909,0,0,1-.7307.8222,5.0884,5.0884,0,0,0-1.1385,1.3595A3.1182,3.1182,0,0,0,12.4191,14.6312Zm.4918,7.0808a8.7726,8.7726,0,0,1-3.51-.7085A8.9859,8.9859,0,0,1,4.6169,16.224a9.0416,9.0416,0,0,1-.0008-7.019,8.9865,8.9865,0,0,1,4.78-4.7838,9.0422,9.0422,0,0,1,7.019-.0007A8.9865,8.9865,0,0,1,21.1984,9.2a9.0422,9.0422,0,0,1,.0007,7.019,8.9859,8.9859,0,0,1-4.78,4.7837A8.7525,8.7525,0,0,1,12.9109,21.712Zm-.0033-1a7.7211,7.7211,0,0,0,5.675-2.325,7.7211,7.7211,0,0,0,2.325-5.675,7.7209,7.7209,0,0,0-2.325-5.675,7.7211,7.7211,0,0,0-5.675-2.325,7.7211,7.7211,0,0,0-5.675,2.325,7.7209,7.7209,0,0,0-2.325,5.675,7.7211,7.7211,0,0,0,2.325,5.675A7.7211,7.7211,0,0,0,12.9076,20.712Z"/>
                            </Button>
                        </StackPanel>
                    </Border>
                    <Border CornerRadius="8" Margin="5,5,0,5" Background="{DynamicResource Black}" Grid.Row="1">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                            <StackPanel >
                                <!--Inheritance-->
                                <Border Background="{StaticResource Dark}" Visibility="{Binding InheritanceVisibility}" CornerRadius="8" Margin="5">

                                    <Grid Margin="5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0" Stretch="Uniform" Data="M4.02,19.0346V14.85a.79.79,0,0,1,.8077-.8153h6.2308a.7934.7934,0,0,1,.8077.8078v4.1847a.79.79,0,0,1-.8077.8153H4.8275a.7934.7934,0,0,1-.8077-.8078Zm0-8.1922V6.6576a.79.79,0,0,1,.8077-.8152h6.2308a.7932.7932,0,0,1,.8077.8077v4.1848a.79.79,0,0,1-.8077.8152H4.8275a.7932.7932,0,0,1-.8077-.8077Zm1-.1923H10.866V6.8424H5.02Zm12.94,8.8635a.808.808,0,0,1-.2955-.053.7816.7816,0,0,1-.2672-.1837l-3.3885-3.3883a.4423.4423,0,0,1-.1338-.3415.5053.5053,0,0,1,.1563-.3505.4512.4512,0,0,1,.3312-.137.4575.4575,0,0,1,.3348.1405l2.7652,2.721V6.3424a.5.5,0,1,1,1,0V17.9211L21.2275,15.2a.4845.4845,0,0,1,.339-.14.4663.4663,0,0,1,.3528.14.4568.4568,0,0,1,.137.341.4724.4724,0,0,1-.14.3475l-3.3885,3.3883a.7721.7721,0,0,1-.27.1837A.8276.8276,0,0,1,17.96,19.5136Z"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <Label Content="Наследуется от:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" />
                                            <TextBlock Margin="12,5,5,5" Style="{StaticResource TextBlockMain}" TextTrimming="WordEllipsis" Foreground="{DynamicResource GrayLight}" Text="{Binding Inheritance}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                                <!--Basic Options-->
                                <Border Background="{StaticResource Dark}" CornerRadius="8" Margin="5">
                                    <StackPanel>
                                        <Grid Margin="5,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0" Data="M7.068.727c.243-.97 1.62-.97 1.864 0l.071.286a.96.96 0 0 0 1.622.434l.205-.211c.695-.719 1.888-.03 1.613.931l-.08.284a.96.96 0 0 0 1.187 1.187l.283-.081c.96-.275 1.65.918.931 1.613l-.211.205a.96.96 0 0 0 .434 1.622l.286.071c.97.243.97 1.62 0 1.864l-.286.071a.96.96 0 0 0-.434 1.622l.211.205c.719.695.03 1.888-.931 1.613l-.284-.08a.96.96 0 0 0-1.187 1.187l.081.283c.275.96-.918 1.65-1.613.931l-.205-.211a.96.96 0 0 0-1.622.434l-.071.286c-.243.97-1.62.97-1.864 0l-.071-.286a.96.96 0 0 0-1.622-.434l-.205.211c-.695.719-1.888.03-1.613-.931l.08-.284a.96.96 0 0 0-1.186-1.187l-.284.081c-.96.275-1.65-.918-.931-1.613l.211-.205a.96.96 0 0 0-.434-1.622l-.286-.071c-.97-.243-.97-1.62 0-1.864l.286-.071a.96.96 0 0 0 .434-1.622l-.211-.205c-.719-.695-.03-1.888.931-1.613l.284.08a.96.96 0 0 0 1.187-1.186l-.081-.284c-.275-.96.918-1.65 1.613-.931l.205.211a.96.96 0 0 0 1.622-.434zM12.973 8.5H8.25l-2.834 3.779A4.998 4.998 0 0 0 12.973 8.5m0-1a4.998 4.998 0 0 0-7.557-3.779l2.834 3.78zM5.048 3.967l-.087.065zm-.431.355A4.98 4.98 0 0 0 3.002 8c0 1.455.622 2.765 1.615 3.678L7.375 8zm.344 7.646.087.065z"/>

                                            <Label Content="Базовые настройки:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>
                                        </Grid>
                                        <ComboBox Style="{StaticResource ComboBoxMain}" ItemsSource="{Binding AvailableComponents}" SelectedItem="{Binding SelectedComponent, Mode=TwoWay}" ToolTip="Компонент, к которому относится класс">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Path Height="15" Width="15" Stretch="Uniform" Fill="{Binding Color, Converter={StaticResource IEColorToBrushConverter}}" Data="{Binding Icon, Converter={StaticResource PathDataToGeometryConverter}}"/>
                                                        <Label FontFamily="{StaticResource Rubik}" Foreground="White" Content="{Binding Name}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                        <TextBox Style="{StaticResource TextBoxMain}" Text="{Binding NameOfClass}" Tag="Наименование класса" MaxLength="50" ToolTip="Наименование класса (везде)"/>
                                        <TextBox Style="{StaticResource TextBoxMain}" Text="{Binding ListName}" Tag="Наименование списка объектов" MaxLength="75" ToolTip="Наименование списка объектов (во всех вкладках, где показывается список объектов класса)"/>
                                    </StackPanel>
                                </Border>
                                <!--TemplateName and Card--> 
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Border Background="{StaticResource Dark}" CornerRadius="8" Margin="5">
                                        <StackPanel>
                                            <Grid Margin="5,5,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="30"/>
                                                    <ColumnDefinition/>
                                                </Grid.ColumnDefinitions>
                                                <Path Fill="{DynamicResource Yellow}" Data="m3.266 12.496.96-2.853H7.76l.96 2.853H10L6.62 3H5.38L2 12.496zm2.748-8.063 1.419 4.23h-2.88l1.426-4.23zm6.132 7.203v-.075c0-.332.234-.618.619-.618.354 0 .618.256.618.58 0 .362-.271.649-.52.898l-1.788 1.832V15h3.59v-.958h-1.923v-.045l.973-1.04c.415-.438.867-.845.867-1.547 0-.8-.701-1.41-1.787-1.41-1.23 0-1.795.8-1.795 1.576v.06z" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0"/>

                                                <Label Content="Наименование объектов:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>
                                            </Grid>
                                            <TextBox x:Name="NameTemplate" Style="{StaticResource TextBoxMain}" Text="{Binding NameTemplate}" Tag="Шаблон названия" MaxLength="75">
                                                <TextBox.ContextMenu>
                                                    <ContextMenu>
                                                        <MenuItem Header="Копировать" Command="ApplicationCommands.Copy"/>
                                                        <MenuItem Header="Вставить" Command="ApplicationCommands.Paste"/>
                                                        <Separator Background="{DynamicResource LightBlack}"/>
                                                        <MenuItem Header="Вставить имя поля" Click="InsertFieldNameClick"/>
                                                    </ContextMenu>
                                                </TextBox.ContextMenu>
                                            </TextBox>
                                        </StackPanel>
                                    </Border>
                                    <Border x:Name="CardArea" Background="{StaticResource Dark}" Grid.Column="1" CornerRadius="8" Margin="5">
                                        <StackPanel>
                                            <Grid Margin="5,5,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="30"/>
                                                    <ColumnDefinition/>
                                                </Grid.ColumnDefinitions>
                                                <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0" Data="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm9 1.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 0-1h-4a.5.5 0 0 0-.5.5M9 8a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 0-1h-4A.5.5 0 0 0 9 8m1 2.5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 0-1h-3a.5.5 0 0 0-.5.5m-1 2C9 10.567 7.21 9 5 9c-2.086 0-3.8 1.398-3.984 3.181A1 1 0 0 0 2 13h6.96q.04-.245.04-.5M7 6a2 2 0 1 0-4 0 2 2 0 0 0 4 0"/>

                                                <Label Content="Карточка объекта:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>
                                            </Grid>
                                            <CheckBox Style="{StaticResource Toggle}" Content="Показывать карточку объекта" IsChecked="{Binding ShowCard}"/>
                                        </StackPanel>
                                    </Border>

                                </Grid>
                                

                                <Border x:Name="AccessArea" Background="{StaticResource Dark}" CornerRadius="8" Margin="5">
                                    <StackPanel>
                                        <Grid Margin="5,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0" Data="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0m-9 8c0 1 1 1 1 1h5v-1a2 2 0 0 1 .01-.2 4.49 4.49 0 0 1 1.534-3.693Q8.844 9.002 8 9c-5 0-6 3-6 4m7 0a1 1 0 0 1 1-1v-1a2 2 0 1 1 4 0v1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zm3-3a1 1 0 0 0-1 1v1h2v-1a1 1 0 0 0-1-1"/>

                                            <Label Content="Доступ:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>

                                        </Grid>
                                        <CheckBox Style="{StaticResource Toggle}" Content="Редактирование объекта доступно только автору" IsChecked="{Binding EditByAuthorOnly}"/>
                                        <CheckBox Style="{StaticResource Toggle}" Content="Разрешить переопределение автора и делегирование" IsChecked="{Binding AuthorOverrideEnabled}"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="{StaticResource Dark}" CornerRadius="8" Margin="5" Grid.Column="1">
                                    <StackPanel>
                                        <Grid Margin="5,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0" Data="M5.6535,19.9578A1.58,1.58,0,0,1,4.038,18.3423V5.5733A1.58,1.58,0,0,1,5.6535,3.9578h12.769A1.58,1.58,0,0,1,20.038,5.5733v7.71q-.2442-.1213-.4942-.2308a4.69,4.69,0,0,0-.5058-.1885V8.727h-6.5v4.4635a5.6186,5.6186,0,0,0-.9577.49,5.7709,5.7709,0,0,0-.8693.6807H5.038v3.9808a.5923.5923,0,0,0,.6155.6155H7.9343q.1594.2807.3287.5212t.3405.4788ZM5.038,13.3615h6.5V8.727h-6.5Zm0-5.6345h14V5.5733a.5923.5923,0,0,0-.6155-.6155H5.6535a.5923.5923,0,0,0-.6155.6155Zm11.1345,14a6.4,6.4,0,0,1-3.3825-.9405,7.1506,7.1506,0,0,1-2.4827-2.521A7.1528,7.1528,0,0,1,12.79,15.7443a6.5545,6.5545,0,0,1,6.7653,0,7.1528,7.1528,0,0,1,2.4827,2.5212,7.1506,7.1506,0,0,1-2.4827,2.521A6.4,6.4,0,0,1,16.1725,21.727Zm0-1a5.4144,5.4144,0,0,0,2.62-.6692,6.3123,6.3123,0,0,0,2.0722-1.7923,6.3085,6.3085,0,0,0-2.0722-1.7922,5.4633,5.4633,0,0,0-5.24,0A6.3085,6.3085,0,0,0,11.48,18.2655a6.3123,6.3123,0,0,0,2.0722,1.7923A5.4141,5.4141,0,0,0,16.1725,20.727Zm0-1.4615a1.001,1.001,0,1,1,.7068-.2932A.9629.9629,0,0,1,16.1725,19.2655Z"/>

                                            <Label Content="Список объектов:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>

                                        </Grid>
                                        <CheckBox x:Name="ButtonPresetsEnabled" Style="{StaticResource Toggle}" Content="Ограничить просмотр общего списка" IsChecked="{Binding PresetsEnabled}"/>
                                        <ListBox Style="{StaticResource ListBoxMain}" MinHeight="40" ItemContainerStyle="{StaticResource ListBoxItemUnselectable}" ItemsSource="{Binding MapFieldsList}" MaxHeight="200">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <CheckBox Style="{StaticResource CheckBoxMain}" MinHeight="15" Margin="2" Content="{Binding Name}" IsEnabled="{Binding BelongsThisClass}" IsChecked="{Binding ListVisibility}"/>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </Border>
                                <Border Background="{StaticResource Dark}" CornerRadius="8" Margin="5" Grid.Column="1">
                                    <StackPanel>
                                        <Grid Margin="5,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition MaxWidth="30"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Stretch="Uniform" Margin="0,0,2,0" Data="M15.0068,10.2514v1.5a.5.5,0,1,0,1,0v-1.5h1.5a.5.5,0,1,0,0-1h-1.5v-1.5a.5.5,0,1,0-1,0v1.5h-1.5a.5.5,0,1,0,0,1Zm-1.5,6h4a.5.5,0,1,0,0-1h-4a.5.5,0,1,0,0,1Zm-2.8845,3.5a1.58,1.58,0,0,1-1.6155-1.6155V5.3669a1.58,1.58,0,0,1,1.6155-1.6155h6.2132a1.5673,1.5673,0,0,1,.6323.1307,1.661,1.661,0,0,1,.5177.348L21.528,7.7726a1.6569,1.6569,0,0,1,.348.5178,1.5669,1.5669,0,0,1,.1308.6322v9.2133a1.58,1.58,0,0,1-1.6155,1.6155Zm0-1h9.769a.6617.6617,0,0,0,.6155-.6155V8.7514l-4-4H10.6223a.6613.6613,0,0,0-.6155.6155v12.769a.6615.6615,0,0,0,.6155.6155Zm-4,5a1.58,1.58,0,0,1-1.6155-1.6155V10.2514a.5.5,0,1,1,1,0V22.1359a.6615.6615,0,0,0,.6155.6155h8.8845a.5.5,0,1,1,0,1Zm3.3845-5v0Z"/>

                                            <Label Content="Контроль уникальности:" FontFamily="{StaticResource Rubik}" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>

                                        </Grid>
                                        <ListBox Style="{StaticResource ListBoxMain}" MinHeight="40" ItemContainerStyle="{StaticResource ListBoxItemUnselectable}" ItemsSource="{Binding MapFieldsList}" MaxHeight="200">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <CheckBox Style="{StaticResource CheckBoxMain}" MinHeight="15" Margin="2" Content="{Binding Name}" IsEnabled="{Binding BelongsThisClass}" IsChecked="{Binding IsUnique}"/>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    <ListBox Style="{StaticResource ListBoxMain}" ItemsSource="{Binding Fields}" ItemContainerStyle="{StaticResource ListBoxItemUnselectable}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" VirtualizingPanel.ScrollUnit="Pixel" Grid.Column="1" Margin="0,5,5,5" Background="{StaticResource Black}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border x:Name="MainBorder" Margin="0" CornerRadius="8" Background="{DynamicResource Dark}">
                                    <Border.Style>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="Height" Value="Auto"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=ExpanderButton, Path=IsChecked}" Value="False">
                                                    <Setter Property="Height" Value="40"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="55*"/>
                                            <ColumnDefinition Width="40" MaxWidth="40"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="40"/>
                                            <RowDefinition Height="2"/>
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.ColumnSpan="2">
                                            <CheckBox x:Name="ExpanderButton" Style="{StaticResource ExpanderButton}" IsChecked="{Binding IsExpanded}" ToolTip="Свернуть / развернуть поле"/>
                                            <Rectangle Width="1" Fill="{DynamicResource Area}" Margin="0,5,0,5" Opacity="0.5" />
                                            <Label Style="{DynamicResource LabelElement}" Content="[" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="{DynamicResource DarkLight}"/>
                                            <TextBox Style="{DynamicResource TextBoxTransparent}" IsEnabled="{Binding BelongsThisClass}" Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" MaxLength="30">
                                                <TextBox.ContextMenu>
                                                    <ContextMenu>
                                                        <MenuItem Header="Копировать" Command="ApplicationCommands.Copy"/>
                                                        <MenuItem Header="Вставить" Command="ApplicationCommands.Paste"/>
                                                    </ContextMenu>
                                                </TextBox.ContextMenu>
                                            </TextBox>
                                            <Label Style="{DynamicResource LabelElement}" Content="]" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="{DynamicResource DarkLight}"/>
                                        </StackPanel>

                                        <Rectangle Grid.Row="1" Fill="{DynamicResource Area}" Grid.ColumnSpan="2" />

                                        <StackPanel Grid.Row="2" x:Name="ContentPanel" IsEnabled="{Binding BelongsThisClass}">

                                            <TextBox Style="{DynamicResource TextBoxMain}" IsReadOnly="False" Tag="Отображаемое название" Text="{Binding VisibleName, UpdateSourceTrigger=PropertyChanged}" MaxLength="50" TextWrapping="Wrap">
                                                <TextBox.ContextMenu>
                                                    <ContextMenu>
                                                        <MenuItem Header="Копировать" Command="ApplicationCommands.Copy"/>
                                                        <MenuItem Header="Вставить" Command="ApplicationCommands.Paste"/>
                                                    </ContextMenu>
                                                </TextBox.ContextMenu>
                                            </TextBox>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="40"/>
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <ComboBox x:Name="ComboType" Style="{DynamicResource ComboBoxMain}" ItemsSource="{Binding DataContext.FieldTypes, RelativeSource={RelativeSource AncestorType=ListBox}}" SelectedItem="{Binding Type}" SelectionChanged="ComboType_SelectionChanged" Grid.Column="1">
                                                    <ComboBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Ellipse Width="5" Height="5" Fill="{Binding ., Converter={StaticResource FieldTypeToColorConverter}}"/>
                                                                <Label Content="{Binding ., Converter={StaticResource FieldTypeToVisibleNameConverter}}" Style="{DynamicResource LabelElement}" FontSize="11"/>
                                                                <Label Content="{Binding ., Converter={StaticResource FieldTypeToVisibleNameConverter}}" Style="{DynamicResource LabelElement}" Foreground="{DynamicResource Icon}" FontSize="10"/>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </ComboBox.ItemTemplate>
                                                </ComboBox>
                                                <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Dark}" ToolTip="Открыть настройки поля" Command="{Binding DataContext.OpenFieldSettings, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding }">
                                                    <Path Fill="White" VerticalAlignment="Center" Data="M7.068.727c.243-.97 1.62-.97 1.864 0l.071.286a.96.96 0 0 0 1.622.434l.205-.211c.695-.719 1.888-.03 1.613.931l-.08.284a.96.96 0 0 0 1.187 1.187l.283-.081c.96-.275 1.65.918.931 1.613l-.211.205a.96.96 0 0 0 .434 1.622l.286.071c.97.243.97 1.62 0 1.864l-.286.071a.96.96 0 0 0-.434 1.622l.211.205c.719.695.03 1.888-.931 1.613l-.284-.08a.96.96 0 0 0-1.187 1.187l.081.283c.275.96-.918 1.65-1.613.931l-.205-.211a.96.96 0 0 0-1.622.434l-.071.286c-.243.97-1.62.97-1.864 0l-.071-.286a.96.96 0 0 0-1.622-.434l-.205.211c-.695.719-1.888.03-1.613-.931l.08-.284a.96.96 0 0 0-1.186-1.187l-.284.081c-.96.275-1.65-.918-.931-1.613l.211-.205a.96.96 0 0 0-.434-1.622l-.286-.071c-.97-.243-.97-1.62 0-1.864l.286-.071a.96.96 0 0 0 .434-1.622l-.211-.205c-.719-.695-.03-1.888.931-1.613l.284.08a.96.96 0 0 0 1.187-1.186l-.081-.284c-.275-.96.918-1.65 1.613-.931l.205.211a.96.96 0 0 0 1.622-.434zM12.973 8.5H8.25l-2.834 3.779A4.998 4.998 0 0 0 12.973 8.5m0-1a4.998 4.998 0 0 0-7.557-3.779l2.834 3.78zM5.048 3.967l-.087.065zm-.431.355A4.98 4.98 0 0 0 3.002 8c0 1.455.622 2.765 1.615 3.678L7.375 8zm.344 7.646.087.065z"/>
                                                </Button>
                                            </Grid>
                                        </StackPanel>
                                        <Rectangle Width="1" Fill="{DynamicResource Area}" Grid.Column="1" Visibility="{Binding BelongsVisibility}" HorizontalAlignment="Left"  Margin="-2,5,0,5" Opacity="0.5" />
                                        <Button x:Name="RemoveButton" Style="{StaticResource ButtonSquare}" Visibility="{Binding BelongsVisibility}" Background="{StaticResource Dark}" ToolTip="Удалить поле" Grid.Column="1" Command="{Binding DataContext.RemoveField, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding }">
                                            <Path Fill="#FFFF7878" VerticalAlignment="Center" Stretch="Uniform" Margin="2" Data="M9.1182,16.61,12.6875,13.04,16.2568,16.61l.6462-.6462L13.3337,12.394,16.903,8.8248l-.6462-.6463-3.5693,3.5693L9.1182,8.1785l-.6462.6463,3.5692,3.5692L8.472,15.9633ZM12.692,21.24a8.6206,8.6206,0,0,1-3.4515-.6973,8.8354,8.8354,0,0,1-4.704-4.6995,8.8864,8.8864,0,0,1,.002-6.8965,8.8363,8.8363,0,0,1,4.7-4.704,8.8876,8.8876,0,0,1,6.8965.002,8.8363,8.8363,0,0,1,4.704,4.7,8.8864,8.8864,0,0,1-.002,6.8965,8.8354,8.8354,0,0,1-4.6995,4.704A8.6053,8.6053,0,0,1,12.692,21.24Zm-.0053-.9233A7.6448,7.6448,0,0,0,18.3025,18.01a7.6411,7.6411,0,0,0,2.308-5.6147A7.6453,7.6453,0,0,0,18.303,6.779a7.6416,7.6416,0,0,0-5.6148-2.308A7.645,7.645,0,0,0,7.0725,6.7785a7.6414,7.6414,0,0,0-2.308,5.6148A7.645,7.645,0,0,0,7.072,18.009,7.6411,7.6411,0,0,0,12.6867,20.317Z"/>
                                        </Button>
                                        <StackPanel Grid.Row="2" Grid.Column="1" VerticalAlignment="Center" Visibility="{Binding BelongsVisibility}">
                                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Dark}"  ToolTip="Поднять выше" Grid.Column="1" Command="{Binding DataContext.MoveUpField, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding }">
                                                <Path Fill="DodgerBlue" VerticalAlignment="Center" Stretch="Uniform" Margin="4" Data="M13.04,11.1856l-4.2463,4.246a.5021.5021,0,0,1-.3442.15.4664.4664,0,0,1-.3633-.15.4716.4716,0,0,1,0-.7075l4.3883-4.3885a.7813.7813,0,0,1,1.131,0l4.3882,4.3885a.5024.5024,0,0,1,.15.3443.4662.4662,0,0,1-.15.3632.4714.4714,0,0,1-.7075,0Z"/>
                                            </Button>
                                            <Button Style="{StaticResource ButtonSquare}" Background="{StaticResource Dark}"  ToolTip="Опустить ниже" Grid.Column="1" Command="{Binding DataContext.MoveDownField, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding }">
                                                <Path Fill="DodgerBlue" VerticalAlignment="Center" Stretch="Uniform" Margin="4" Data="M -13.04 -11.1856 l 4.2463 -4.246 a 0.5021 0.5021 180 0 1 0.3442 -0.15 a 0.4664 0.4664 180 0 1 0.3633 0.15 a 0.4716 0.4716 180 0 1 0 0.7075 l -4.3883 4.3885 a 0.7813 0.7813 180 0 1 -1.131 0 l -4.3882 -4.3885 a 0.5024 0.5024 180 0 1 -0.15 -0.3443 a 0.4662 0.4662 180 0 1 0.15 -0.3632 a 0.4714 0.4714 180 0 1 0.7075 -0 Z"/>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </TabItem>
            <!--<TabItem Header="Проверка">
                <ngv:FlowChartView Background="{DynamicResource Black}" DataContext="{Binding FlowChartViewModel}" />
            </TabItem>-->
            <TabItem Header="Методы" BorderBrush="{DynamicResource LightPurple}">
                <Grid Background="{DynamicResource Black}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350" />
                        <ColumnDefinition Width="5*"/>
                    </Grid.ColumnDefinitions>
                    <Border CornerRadius="8" Margin="5,5,0,5" Background="{DynamicResource Black}" Grid.Row="1">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                            <StackPanel>
                                <Border Background="{StaticResource Dark}" CornerRadius="8" Margin="5">
                                    <StackPanel>
                                        <Grid Margin="5,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Path Fill="{DynamicResource Yellow}" Data="M8 0a1 1 0 0 1 1 1v5.268l4.562-2.634a1 1 0 1 1 1 1.732L10 8l4.562 2.634a1 1 0 1 1-1 1.732L9 9.732V15a1 1 0 1 1-2 0V9.732l-4.562 2.634a1 1 0 1 1-1-1.732L6 8 1.438 5.366a1 1 0 0 1 1-1.732L7 6.268V1a1 1 0 0 1 1-1" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0"/>

                                            <Label Content="Модуль:" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>
                                        </Grid>
                                        <Button Style="{StaticResource ButtonMainFinish}" Click="GenerateBaseScriptClick">
                                            <StackPanel Orientation="Horizontal">
                                                <Path Fill="White" Data="M1 8a7 7 0 1 1 2.898 5.673c-.167-.121-.216-.406-.002-.62l1.8-1.8a3.5 3.5 0 0 0 4.572-.328l1.414-1.415a.5.5 0 0 0 0-.707l-.707-.707 1.559-1.563a.5.5 0 1 0-.708-.706l-1.559 1.562-1.414-1.414 1.56-1.562a.5.5 0 1 0-.707-.706l-1.56 1.56-.707-.706a.5.5 0 0 0-.707 0L5.318 5.975a3.5 3.5 0 0 0-.328 4.571l-1.8 1.8c-.58.58-.62 1.6.121 2.137A8 8 0 1 0 0 8a.5.5 0 0 0 1 0" VerticalAlignment="Center"/>
                                                <Label Foreground="White" Content="Сгенерировать модуль для этого класса" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </Button>

                                        <MenuItem Style="{StaticResource Command}" Header="Определить новый метод"/>
                                        <MenuItem Style="{StaticResource Command}" Header="Создать обработчик при сохранении объекта"/>
                                        <MenuItem Style="{StaticResource Command}" Header="Создать обработчик при валидации объекта"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="{StaticResource Dark}" CornerRadius="8" Margin="5">
                                    <StackPanel>
                                        <Grid Margin="5,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Path Fill="{DynamicResource Yellow}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,2,0" Data="M7.752.066a.5.5 0 0 1 .496 0l3.75 2.143a.5.5 0 0 1 .252.434v3.995l3.498 2A.5.5 0 0 1 16 9.07v4.286a.5.5 0 0 1-.252.434l-3.75 2.143a.5.5 0 0 1-.496 0l-3.502-2-3.502 2.001a.5.5 0 0 1-.496 0l-3.75-2.143A.5.5 0 0 1 0 13.357V9.071a.5.5 0 0 1 .252-.434L3.75 6.638V2.643a.5.5 0 0 1 .252-.434zM4.25 7.504 1.508 9.071l2.742 1.567 2.742-1.567zM7.5 9.933l-2.75 1.571v3.134l2.75-1.571zm1 3.134 2.75 1.571v-3.134L8.5 9.933zm.508-3.996 2.742 1.567 2.742-1.567-2.742-1.567zm2.242-2.433V3.504L8.5 5.076V8.21zM7.5 8.21V5.076L4.75 3.504v3.134zM5.258 2.643 8 4.21l2.742-1.567L8 1.076zM15 9.933l-2.75 1.571v3.134L15 13.067zM3.75 14.638v-3.134L1 9.933v3.134z"/>

                                            <Label Content="Работа с полями:" Foreground="{DynamicResource GrayLight}" Grid.Column="1"/>
                                        </Grid>
                                        <Border Background="{StaticResource Black}" CornerRadius="8" Margin="5" MinHeight="40">
                                            <StackPanel x:Name="ScriptFieldsPanel">

                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    <avalonEdit:TextEditor x:Name="CodeModule" Grid.Column="1" HorizontalScrollBarVisibility="Disabled" Background="{x:Null}" ShowLineNumbers="True" BorderThickness="0" Document="{Binding CodeModule}" BorderBrush="{DynamicResource Dark}" FontSize="13" FontFamily="{StaticResource JetBrains}" Foreground="White" Margin="10,0,0,0">
                    </avalonEdit:TextEditor>
                </Grid>
            </TabItem>
            <TabItem Header="Статусы" BorderBrush="{DynamicResource LightPurple}">

            </TabItem>
            <TabItem Header="Состояния" BorderBrush="{DynamicResource LightPurple}">
                
            </TabItem>
        </TabControl>
        <StackPanel Grid.Row="2" Grid.ColumnSpan="3" Margin="5,0,0,0" Orientation="Horizontal">
            <Button Style="{DynamicResource ButtonRectangle}" Background="{StaticResource Dark}" VerticalAlignment="Center"  IsDefault="True" Click="SaveClick" Grid.Row="3">
                <StackPanel Orientation="Horizontal" Margin="5,0,5,0">
                    <Path Fill="{StaticResource Buttons.Green}" Data="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" VerticalAlignment="Center"/>
                    <Label Foreground="White" Content="Сохранить класс"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</Window>
